# Virtual Hosts
#
# Required modules: mod_log_config

# If you want to maintain multiple domains/hostnames on your
# machine you can setup VirtualHost containers for them. Most configurations
# use only name-based virtual hosts so the server doesn't need to worry about
# IP addresses. This is indicated by the asterisks in the directives below.
#
# Please see the documentation at
# <URL:http://httpd.apache.org/docs/2.4/vhosts/>
# for further details before you try to setup virtual hosts.
#
# You may use the command line option '-S' to verify your virtual host
# configuration.

#
# VirtualHost example:
# Almost any Apache directive may go into a VirtualHost container.
# The first VirtualHost section is used for all requests that do not
# match a ServerName or ServerAlias in any <VirtualHost> block.
#

#https://auth0.com/blog/sso-for-legacy-apps-with-auth0-openid-connect-and-apache/

<VirtualHost *:80>
    ServerAdmin webmaster@dummy-host.example.com
    DocumentRoot "/usr/local/apache2/htdocs"
    ServerName dummy-host.example.com

    OIDCProviderMetadataURL ${OIDC_METADATA_URL}

    OIDCClientID ${OIDC_CLIENT_ID}
    OIDCClientSecret ${OIDC_CLIENT_SECRET}

    OIDCScope "openid email profile"
    OIDCRedirectURI ${OIDC_REDIRECT_URI}
    OIDCCryptoPassphrase ${OIDC_PASSPHRASE}
    OIDCCookiePath /

    #SSLEngine on
    #SSLCertificateFile /home/your_cert.crt
    #SSLCertificateKeyFile /home/your_key.key

    <Location />
      AuthType openid-connect
      Require valid-user
      LogLevel debug

      ProxyPass ${PROXY_PASS}
      ProxyPassReverse ${PROXY_PASS}
    </Location>
</VirtualHost>
